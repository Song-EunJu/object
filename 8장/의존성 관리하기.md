## 8장 : 의존성 관리하기

- 작고 응집도 높은 객체 == 책임의 초점 명확, 한 가지 일만 잘하는 객체
- 객체지향 설계의 핵심은 `협력` 을 위해 `필요한 의존성은 유지` 하면서도, `변경`을 `방해하는 의존성은 제거`

### 의존성 이해하기

- 어떤 객체가 협력하기 위해 다른 객체를 필요로 할 때, 두 객체 사이에 의존성이 존재하게 됨
- 의존성은 각 시점에 따라 서로 다른 의미를 가짐
    
    ```markdown
    - 의존하는 객체 : PeriodCondition
    - 의존대상 객체(의존되는 객체) : Screening
    ```
    
    - 실행 시점 : 의존하는 객체가 정상 동작하려면, 실행 시에 의존대상 객체가 존재해야 함
        - 어떤 객체가 `예정된` 작업을 정상 수행하기 위해 다른 객체를 필요로 할 경우
    - 구현 시점 : 의존대상 객체가 변경될 경우, 의존하는 객체도 함께 변경됨
        - Screening 이 변경될 때 PeriodCondition 이 영향을 받지만, 그 역은 성립 X 
        → 의존성은 방향성을 가지며, 항상 단방향
- **의존성 : 변경에 의한 영향의 전파 가능성 / 의존하고 있는 대상의 변경에 영향을 받을 수 있는 가능성**

```java
public class PeriodCondition implements DiscountCondition {
    private DayOfWeek dayOfWeek;
    private LocalTime startTime;
    private LocalTime endTime;
    ... 
    public boolean isSatisfiedBy(Screening screening) {
        return **screening.getStartTime()**.getDayOfWeek().equals(dayOfWeek) &&
                **startTime.compareTo**(screening.getStartTime().toLocalTime()) <= 0&&
                endTime.compareTo(screening.getStartTime().toLocalTime()) >= 0;
    }
}
```

- DayOfWeek 인스턴스에게 compareTo 메시지 전송
- Screening 인스턴스에게 getStartTime 메시지 전송
- 즉, PeriodCondition 이 가질 수 있는 의존성은 총 4가지
    - DayOfWeek, LocalTime 은 인스턴스 변수로서 의존성을 갖게 됨
    - Screening 은 메소드 인자로서 의존성을 갖게 됨
    - DiscountCondition 은 부모 클래스로서 의존성을 갖게 됨 → 퍼블릭 인터페이스

### 의존성 전이

- 직접 의존성 : 한 요소가 다른 요소에 직접 의존하는 경우
    - PeriodCondition 이 Screening 에 의존하는 경우
- 간접 의존성 : 직접 관계는 존재하지 않지만, 의존성 전이에 의해 영향이 전파되는 경우
    - PeriodCondition이 Screening 에 의존하는데, Screening 이 의존하는 대상에 대해서 PeriodCondition 에게 의존성이 전파되는 경우
- 의존성 전이 여부는 변경 방향, 캡슐화 정도에 따라 달라짐
